#!/usr/bin/env bash
source /dev/stdin < <(cli shim)

help() {
cat << EOF
Command
    cli find commands

Arguments
    --dir -d                : Directory to search.
    --recursive  -r  [Flag] : Recurse.

Global Arguments
    --help -h        [Flag] : Show this message and exit.
    --self-test      [Flag] : Runs a self test.
EOF
}

main() (
    cd "${arg_dir}"
    for entry in *; do 
        if [ -f "${entry}" ] && [ -x "${entry}" ]; then
            echo "$(pwd)/${entry}"
        fi
    done

    if [[ ! "${arg_recursive}" == 'true' ]]; then
        exit
    fi

    for entry in *; do 
        if [ -d "${entry}" ] && [ -x "${entry}" ]; then
            cli find commands --dir "$(pwd)/${entry}" --recursive
        fi
    done
)

shim "$@"